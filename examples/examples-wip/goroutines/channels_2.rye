; example using more Rye features

jobs: new-channel 5
done: new-channel 0

go does {
    print "waiting to process jobs"
    forever {
        read jobs |^fix {
            print "recieved all jobs"
            send done 1
        }
		|print\val "received job {{}}"
        sleep 1000
    }
}

loop 3 {
    .send* jobs ,
    .print\val "sent job {{}}"
}
close jobs

print "waiting for jobs to finish"
read done
print "finished"
